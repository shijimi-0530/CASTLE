<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-5">
      <span>
        <%= link_to "マイページ", mypage_users_path %>  会員情報の編集
      </span>

      <h2 class="mt-3 mb-3">会員情報の編集</h2>

      <hr>

      <%= form_with url: mypage_users_path, local: true, method: :put do |f| %>
      
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :first_name, "名", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userLast_Name', '.editUserLast_Name', '.userNameEditLabel');" class="userLast_NameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userlast_name">
            <h3 class="castle-edit-user-info-value"><%= @user.last_name %></h3>
          </div>
          <div class="collapse edituserlast_name">
            <%=
              f.text_field :last_name,
              class: "form-control #{"is-invalid" if @user.errors.messages[:last_name].present? } ",
              value: @user.last_name,
              autofocus: "true",
              required: "",
              autocomplete: "last_name",
              placeholder: "姓を入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:last_name].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>姓を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>
        
        <hr>
          
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :first_name, "名", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.first_name %></h3>
          </div>
          <div class="collapse editUserName">
            <%=
              f.text_field :first_name,
              class: "form-control #{"is-invalid" if @user.errors.messages[:first_name].present? } ",
              value: @user.first_name,
              autofocus: "true",
              required: "",
              autocomplete: "first_name",
              placeholder: "名を入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:first_name].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>名を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>
        
        <hr>
          
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :last_name_kana, "姓（カナ）", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.last_name_kana %></h3>
          </div>
          <div class="collapse editUserName">
            <%=
              f.text_field :last_name_kana,
              class: "form-control #{"is-invalid" if @user.errors.messages[:last_name_kana].present? } ",
              value: @user.last_name_kana,
              autofocus: "true",
              required: "",
              autocomplete: "last_name_kana",
              placeholder: "姓（カナ）を入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:last_name_kana].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>姓（カナ）を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>
        
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :first_name_kana, "名（カナ）", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.first_name_kana %></h3>
          </div>
          <div class="collapse editUserName">
            <%=
              f.text_field :first_name_kana,
              class: "form-control #{"is-invalid" if @user.errors.messages[:first_name_kana].present? } ",
              value: @user.first_name_kana,
              autofocus: "true",
              required: "",
              autocomplete: "first_name_kana",
              placeholder: "名（カナ）を入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:first_name_kana].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>名（カナ）を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>

        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :email, "メールアドレス", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userMail', '.editUserMail', '.userMailEditLabel');" class="userMailEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userMail">
            <h3 class="castle-edit-user-info-value"><%= @user.email %></h3>
          </div>
          <div class="collapse editUserMail">
            <%=
              f.email_field :email,
              class: "form-control #{"is-invalid" if @user.errors.messages[:email].present? }",
              autofocus: "true",
              required: "",
              value: @user.email,
              autocomplete: "email",
              placeholder: "メールアドレスを入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:email].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>メールアドレスを入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>
        
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :nickname, "ニックネーム", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.nickname %></h3>
          </div>
          <div class="collapse editUserName">
            <%=
              f.text_field :nickname,
              class: "form-control #{"is-invalid" if @user.errors.messages[:nickname].present? } ",
              value: @user.nickname,
              autofocus: "true",
              required: "",
              autocomplete: "nickname",
              placeholder: "ニックネームを入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:nickname].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>ニックネームを入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>
        
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :gender, "性別", class: "text-md-left castle-edit-user-info-label" %>

            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.gender %></h3>
          </div>
          <div class="collapse editUserName">
            <%= f.label :"男性"  %>
            <%= f.radio_button :gender, :man %>
            <%= f.label :"女性"  %>
            <%= f.radio_button :gender, :woman %>
            <br>
          <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>
            <% if @user.errors.messages[:gender].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>性別を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>
        
        <div class="form-group">
          <div class="d-flex justify-content-between">
            <%= f.label :birth_date, "生年月日", class: "text-md-left castle-edit-user-info-label" %>
            <span onclick="switchEditUserInfo('.userName', '.editUserName', '.userNameEditLabel');" class="userNameEditLabel user-edit-label">
              編集
            </span>
          </div>
          <div class="collapse show userName">
            <h3 class="castle-edit-user-info-value"><%= @user.birth_date %></h3>
          </div>
          <div class="collapse editUserName">
            <%=
              f.text_field :birth_date,
              class: "form-control #{"is-invalid" if @user.errors.messages[:birth_date].present? } ",
              value: @user.birth_date,
              autofocus: "true",
              required: "",
              autocomplete: "birth_date",
              placeholder: "生年月日を入力"
            %>

            <%= f.submit "保存", class: "btn castle-submit-button mt-3 w-25" %>

            <% if @user.errors.messages[:birth_date].present? %>
            <span class="invalid-feedback" role="alert">
              <strong>生年月日を入力してください</strong>
            </span>
            <% end %>
          </div>
        </div>

        <hr>
 

      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript">
    let switchEditUserInfo = (textClass, inputClass, labelClass) => {
        if ($(textClass).css('display') == 'block') {
            $(labelClass).text("キャンセル");
            $(textClass).collapse('hide');
            $(inputClass).collapse('show');
        } else {
            $(labelClass).text("編集");
            $(textClass).collapse('show');
            $(inputClass).collapse('hide');
        }
    }
</script>
